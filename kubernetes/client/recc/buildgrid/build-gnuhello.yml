apiVersion: batch/v1
kind: Job
metadata:
  name: build-gnuhello
  namespace: buildgrid
spec:
  template:
    metadata:
      name: build-gnuhello
    spec:
      containers:
      - name: build-gnuhello
        image: remoteapistesting/recc-build:latest
        command: ["/bin/bash", "-x", "-c"]
        args:
         - apt update && apt install -y wget;
           wget https://ftp.gnu.org/gnu/hello/hello-2.10.tar.gz;
           tar xvf hello-2.10.tar.gz;
           cd hello-2.10;
           ./configure;
           export RECC_SERVER=buildgrid-stack:50051;
           make CC="recc cc";
           ./hello
      restartPolicy: Never
  backoffLimit: 0
